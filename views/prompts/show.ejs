<% include ../partials/header_partial.ejs %>


<!-- prompt's show -->

	<section class="prompt">
	<h3><%= prompt.promptBody %></h3>
	</section>

	


	<% if (prompt.responses.length == 0) { %>

		<section class="response">
			<p>No one has responded yet. Be the first to response to this prompt!</p>
		</section> <!-- this needs to be styled -->

	<% } %>


	<% for (var i = 0; i < prompt.responses.length; i++) { %>

		<section class="response">

			<p><%= prompt.responses[i].responseBody %></p>

			<!-- <p>Author: <%= prompt.responses[i].author %></p> -->

		<div class="response-bottom">
			<span class="response-bottom-span">By <a href="/users/<%= prompt.responses[i].authorid %>"><%= prompt.responses[i].author %></a> on <%= prompt.responses[i].timestamp.toDateString() %></span>


			<!-- hide is user is not the author -->

			<% if (prompt.responses[i].author === locals.username) { %>

			<span class="rb-edit-delete">

				<a href="../prompts/edit/<%= prompt.responses[i].id %>" text-decoration="none"><img src="../img/pencil.png" class="edit-delete-icon"></a>

				<form action="/prompts/delete/<%= prompt.responses[i].id %>?_method=DELETE" method="POST" class="hidden" display="inline"><input type="image" src="../img/trash.png" class="edit-delete-icon"></form>

			</span>

				<%# if the user has posed already, save as variable %>
				<% var userPosted = true %>



			<% } %>

		</div> <!-- closes response-bottom div -->

		</section>

	<% } %>
	


	<!-- HIDE IF USER IS NOT LOGGED IN OR IF USER HAS ALREADY POSTED -->
	<% if (locals.login && !userPosted) { %>
		<!-- form to post a new response -->
		<form action="/prompts/<%= prompt.id %>/newresponse" method="POST" id="post-response">
		<textarea name="responseBody" form="post-response" placeholder="<%= prompt.promptBody %>"></textarea>
		<input type="submit">
		</form>

	<% } %>


	<% if (userPosted) { %>

	<div class="message">

		<p>You have already responded to this prompt! Find another prompt, post your own, or edit your submission.</p>

		<!-- is there a way I can grab what the user has already done... make it easier for the user to find their submission. -->

	</div>


	<% } %>


	<footer></footer>

</div> <!-- closes content-container div -->


</div> <!-- closes super-container div -->



</body>
</html>